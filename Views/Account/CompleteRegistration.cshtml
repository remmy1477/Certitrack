@model Certitrack.ViewModels.CompleteRegistrationVM

@{
    Layout = "_SignUpLayout";
    ViewData["Title"] = "Complete Registration";
}

<div id="content" class="content mt-5">
    @* <h1 class="page-header text-center mb-4">Complete Your Registration</h1> *@

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10">
                <div class="card" style="margin-top:100px;">
                    <div class="card-header bg-primary text-white">
                        User Details
                    </div>
                    <div class="card-body">
                        @if (!ViewData.ModelState.IsValid)
                        {
                            <div class="alert alert-danger">
                                @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                                {
                                    <div>@error.ErrorMessage</div>
                                }
                            </div>
                        }
                        @if (TempData["Message"] != null)
                        {
                            <div class="alert alert-success alert-dismissible fade show" role="alert">
                                @TempData["Message"]
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        }
                        <form asp-action="CompleteRegistration" method="post" novalidate>
                            @Html.AntiForgeryToken()

                            <input type="hidden" asp-for="Email" />
                            <input type="hidden" asp-for="RoleId" />
                            <input type="hidden" asp-for="Token" />
                            <input type="hidden" asp-for="TypeId" />

                            <div class="row g-3">
                                <!-- Group: Personal Information -->
                                <div class="col-12">
                                    <h5>Personal Information</h5>
                                    <hr />
                                </div>
                                <div class="col-md-4">
                                    @* <label asp-for="Title" class="form-label">Title</label> *@
                                    <select asp-for="Title" class="form-select" asp-items="ViewBag.Titles">
                                        <option value="0">-- Select Title --</option>
                                    </select>
                                    <span asp-validation-for="Title" class="text-danger"></span>
                                </div>

                                <div class="col-md-4">
                                    @* <label asp-for="FirstName" class="form-label"></label> *@
                                    <input asp-for="FirstName" class="form-control" placeholder="FirstName" />
                                    <span asp-validation-for="FirstName" class="text-danger"></span>
                                </div>

                                <div class="col-md-4">
                                    @* <label asp-for="LastName" class="form-label"></label> *@
                                    <input asp-for="LastName" class="form-control" placeholder="LastName" />
                                    <span asp-validation-for="LastName" class="text-danger"></span>
                                </div>

                                <div class="col-md-4">
                                    @* <label asp-for="Phone" class="form-label"></label> *@
                                    <input asp-for="Phone" class="form-control" placeholder="Phone" />
                                    <span asp-validation-for="Phone" class="text-danger"></span>
                                </div>
                                <div class="col-md-12">
                                    @* <label asp-for="Address" class="form-label"></label> *@
                                    <input asp-for="Address" class="form-control" placeholder="Address" />
                                    <span asp-validation-for="Address" class="text-danger"></span>
                                </div>

                                <!-- Group: Personal Information -->
                                <div class="col-12">
                                    <h5>Organisation Information</h5>
                                    <hr />
                                </div>
                                @if (Model.TypeId != 3)
                                {
                                    <div class="col-md-4">
                                        @* <label asp-for="Phone" class="form-label"></label> *@
                                        <input asp-for="OrganizationName" class="form-control" placeholder="Organization Name" />
                                        @*  <span asp-validation-for="Phone" class="text-danger"></span> *@
                                    </div>
                                    <div class="col-md-4">
                                        @* <label asp-for="Phone" class="form-label"></label> *@
                                        <input asp-for="OrganizationPhone" class="form-control" placeholder="Organization Phone" />
                                        @*  <span asp-validation-for="Phone" class="text-danger"></span> *@
                                    </div>
                                    <div class="col-md-4">
                                        @* <label asp-for="Phone" class="form-label"></label> *@
                                        <input asp-for="OrganizationEmail" class="form-control" placeholder="Organization Email" />
                                        @*  <span asp-validation-for="Phone" class="text-danger"></span> *@
                                    </div>
                                    <div class="col-md-4">
                                        @* <label asp-for="Phone" class="form-label"></label> *@
                                        <input asp-for="RCNo" class="form-control" placeholder="RC No." />
                                        @*  <span asp-validation-for="Phone" class="text-danger"></span> *@
                                    </div>
                                    <div class="col-md-4">
                                        @* <label asp-for="Phone" class="form-label"></label> *@
                                        <input asp-for="ITNo" class="form-control" placeholder="IT No." />
                                        @*  <span asp-validation-for="Phone" class="text-danger"></span> *@
                                    </div>
                                    <div class="col-md-4">
                                        @* <label asp-for="Phone" class="form-label"></label> *@
                                        <input asp-for="BNNo" class="form-control" placeholder="BN No." />
                                        @*  <span asp-validation-for="Phone" class="text-danger"></span> *@
                                    </div>
                                    <div class="col-md-12">
                                        @* <label asp-for="Phone" class="form-label"></label> *@
                                        <input asp-for="OrganizationAddress" class="form-control" placeholder="Organization Address" />
                                        @*  <span asp-validation-for="Phone" class="text-danger"></span> *@
                                    </div>
                                }
                                else if (Model.TypeId == 3)
                                {
                                    <input type="hidden" asp-for="OrganizationName" />
                                    <input type="hidden" asp-for="OrganizationPhone" />
                                    <input type="hidden" asp-for="OrganizationEmail" />
                                    <input type="hidden" asp-for="RCNo" />
                                    <input type="hidden" asp-for="ITNo" />
                                    <input type="hidden" asp-for="ITNo" />
                                    <input type="hidden" asp-for="BNNo" />
                                    <input type="hidden" asp-for="OrganizationAddress" />
                                    <div class="col-md-4">
                                        @* <label asp-for="Title" class="form-label">Title</label> *@
                                        <select asp-for="SchoolId" class="form-select" asp-items="ViewBag.schools">
                                            <option value="0">-- Select School --</option>
                                        </select>
                                        <span asp-validation-for="SchoolId" class="text-danger"></span>
                                    </div>

                                }

                                <!-- Group: Personal Information -->
                                <div class="col-12">
                                    <h5>User Account Security</h5>
                                    <hr />
                                </div>
                              
                                <div class="col-md-4">
                                    @* <label asp-for="Password" class="form-label"></label> *@
                                    <input asp-for="Password" class="form-control" type="password" placeholder="Password" />
                                    <span asp-validation-for="Password" class="text-danger"></span>
                                </div>

                                <div class="col-md-4">
                                    @* <label asp-for="ConfirmPassword" class="form-label"></label> *@
                                    <input asp-for="ConfirmPassword" class="form-control" type="password" placeholder="ConfirmPassword" />
                                    <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                                </div>
                               
                            </div>

                            <div class="form-check mt-4">
                                <input class="form-check-input" type="checkbox" id="disclaimerCheck" disabled />
                                <label class="form-check-label" for="disclaimerCheck">
                                    I have read and accepted the disclaimer.
                                </label>
                                <span id="disclaimerError" class="text-danger d-none">You must agree before submitting.</span>
                            </div>

                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary" id="submitBtn" disabled>Complete Registration</button>
                                <button type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#disclaimerModal">
                                    Read Disclaimer
                                </button>
                            </div>
                        </form>  
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="disclaimerModal" tabindex="-1" role="dialog" aria-labelledby="disclaimerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="disclaimerModalLabel">Disclaimer</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="max-height: 400px; overflow-y: auto;">
                <p>
                    <strong>DISCLAIMER FOR USERS OF THE DIGITAL PLATFORM</strong><br /><br />
                    BY USING THIS PLATFORM, YOU ACKNOWLEDGE AND AGREE THAT:
                </p>
                <ol type="a">
                    <li>
                        The information provided and obtained on the platform is directly from the university/college/institution.
                        While CertiTrack strives to ensure that the content is obtained directly from the university/college/institution,
                        no guarantees are made regarding the completeness, accuracy, reliability, suitability of any information,
                        content, or materials found on or through the platform as it does not have any input and cannot edit or retain
                        the information which moves directly from the university/college/institution to the user.
                    </li>
                    <li>
                        CertiTrack shall not be held liable for any damages resulting from the use of or reliance on any content,
                        information, or services provided by the school/university through the platform.
                    </li>
                </ol>
            </div>
            <div class="modal-footer">
                @* <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> *@
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

            </div>
        </div>
    </div>
</div>



@section Scripts {
    <partial name="_ValidationScriptsPartial" />
   @*  <script>
        document.querySelector('form').addEventListener('submit', function (e) {
            const check = document.getElementById('disclaimerCheck');
            const error = document.getElementById('disclaimerError');

            if (!check.checked) {
                e.preventDefault();
                error.classList.remove('d-none');
            } else {
                error.classList.add('d-none');
            }
        });
    </script> *@
    <script>
        document.querySelector('form').addEventListener('submit', function (e) {
            const check = document.getElementById('disclaimerCheck');
            const error = document.getElementById('disclaimerError');

            if (!check.checked) {
                e.preventDefault();
                error.classList.remove('d-none');
            } else {
                error.classList.add('d-none');
            }
        });

        // Enable checkbox and button when modal closes
        const disclaimerModal = document.getElementById('disclaimerModal');
        disclaimerModal.addEventListener('hidden.bs.modal', function () {
            const check = document.getElementById('disclaimerCheck');
            const submit = document.getElementById('submitBtn');
            check.disabled = false;
            check.checked = true;
            submit.disabled = false;
        });
    </script>
}
